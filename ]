import sys

additional_contribution_amount = 0
additional_contribution_frequency = 'monthly'
debts = [] # loan_amount, interest_rate, term_length, current_balance

def collect_debt_information():
    current_balance = None
    interest_rate = None
    loan_amount = None
    term_length = None

    print("What is the current balance of the loan?")
    current_balance = collect_input("currency")

    print("What is the interest rate of the loan?")
    interest_rate = collect_input("numerical")

    print("What was the original amount of the loan?")
    loan_amount = collect_input("currency")

    print("What is the term length of the loan?")
    term_length = collect_input("numerical")

def collect_input(type):
    formalized_input = normalize_input(input())

    if validate_input(type, formalized_input):
        print(f"{formalized_input} was not valid")
        # TODO: do something

    return formalized_input 

def convert_to_float(input):
    try:
        str_input = convert_to_str(input)
        stripped_str_input = strip_common_numerical_characters_from_str(str_input)
        print(stripped_str_input)
        return float(stripped_str_input)
    except (TypeError, ValueError) as e:
        raise ValueError(f"Could not convert {input!r} to float") from e

def convert_to_str(input):
    if isinstance(input, str):
        return input
    else:
        try:
            return str(input)
        except Exception as e:
            raise Exception(f"Could not convert {input!r} to string") from e

def normalize_input(input):
    modified_input = input

    modified_input.lower()
    
    if type == "numerical":
        modified_input = modified_input.strip("$,")

        if "%" in input:
            modified_input = modified_input.strip("%")
            modified_input /= 100

    return modified_input

def strip_common_numerical_characters_from_str(input):
    if isinstance(input, str):
        return input.replace("$,", "") 
    else:
        raise TypeError(f"{input!r} is not a string; cannot strip")

def validate_input_frequency(input):
    if input in ["bi-monthly", "bi-weekly", "monthly", "weekly", "yearly"]:
        return True
    else:
        return False

def validate_input_numerical(input):
    try:
        convert_to_float(input)
        return True
    except (TypeError, ValueError):
        print(f"{input!r} could not be converted to a decimal")
        return False

# type = frequency, numerical
# frequency = ['yearly', 'weekly', 'bi-weekly', 'monthly', 'bi-monthly']
def validate_input(type, input):
    valid = True

    if type == "numerical":
        valid = validate_input_numerical(input)
    elif type == "frequency":
        valid = validate_input_frequency(input)

    return valid
    
def main():
    print("I'm going to ask you a series of questions about your debts and any additional contributions you want to make towards your monthly debt. Each debt will require the original loan amount, interest rate, term length, and the current balance.")

    collect_debt_information()

